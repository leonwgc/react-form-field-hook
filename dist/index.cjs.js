"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }var P=(n,e,r)=>new Promise((t,m)=>{var b=a=>{try{T(r.next(a))}catch(d){m(d)}},c=a=>{try{T(r.throw(a))}catch(d){m(d)}},T=a=>a.done?t(a.value):Promise.resolve(a.value).then(b,c);T((r=r.apply(n,e)).next())});var _react = require('react'); var _react2 = _interopRequireDefault(_react);var se={required:(n="This field is required")=>e=>!e||!e.trim()?n:null,email:(n="Invalid email format")=>e=>e&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?n:null,minLength:(n,e)=>r=>r&&r.length<n?e||`Minimum ${n} characters`:null,maxLength:(n,e)=>r=>r&&r.length>n?e||`Maximum ${n} characters`:null,pattern:(n,e)=>r=>r&&!n.test(r)?e:null,min:(n,e)=>r=>{let t=typeof r=="string"?parseFloat(r):r;return!isNaN(t)&&t<n?e||`Minimum value is ${n}`:null},max:(n,e)=>r=>{let t=typeof r=="string"?parseFloat(r):r;return!isNaN(t)&&t>n?e||`Maximum value is ${n}`:null},url:(n="Invalid URL format")=>e=>{try{return e&&new URL(e),null}catch(r){return n}},number:(n="Must be a number")=>e=>e&&isNaN(Number(e))?n:null,integer:(n="Must be an integer")=>e=>e&&!Number.isInteger(Number(e))?n:null,matches:(n,e="Values do not match")=>r=>r!==n()?e:null,oneOf:(n,e)=>r=>n.includes(r)?null:e||`Must be one of: ${n.join(", ")}`,validate:(n,e)=>r=>P(null,null,function*(){return(yield Promise.resolve(n(r)))?null:e}),phone:(n="Invalid phone number")=>e=>e&&!/^[\d\s\-+()]{7,}$/.test(e)?n:null};function te(n={}){let{initialValue:e="",rules:r=[],validateOnChange:t=!0,validateOnBlur:m=!0,validateDebounce:b=0,transform:c,compareWith:T,onValueChange:a,onValidationChange:d,disabled:L=!1}=n,[l,p]=_react.useState.call(void 0, e),[v,h]=_react.useState.call(void 0, !1),[o,u]=_react.useState.call(void 0, !1),[F,w]=_react.useState.call(void 0, !1),[M,A]=_react.useState.call(void 0, null),[$,k]=_react.useState.call(void 0, !1),[g,K]=_react.useState.call(void 0, L),D=_react.useRef.call(void 0, e),V=_react.useRef.call(void 0, ),S=_react.useRef.call(void 0, 0),U=_react.useMemo.call(void 0, ()=>T?!T(l,D.current):l!==D.current,[l,T]),q=!U,x=M!==null,W=!x&&!$,B=_react.useCallback.call(void 0, i=>P(null,null,function*(){if(r.length===0)return null;let f=++S.current;k(!0);try{for(let N of r){let I=yield Promise.resolve(N(i));if(f!==S.current)return null;if(I)return k(!1),I}return k(!1),null}catch(N){return k(!1),"Validation error occurred"}}),[r]),H=_react.useCallback.call(void 0, (i,f=!1)=>P(null,null,function*(){V.current&&clearTimeout(V.current);let N=()=>P(null,null,function*(){let I=yield B(i);A(I),d&&d(I===null,I)});f||b===0?yield N():V.current=setTimeout(N,b)}),[B,b,d]),y=_react.useCallback.call(void 0, i=>{if(g)return;let f=c?c(i):i;p(f),a&&a(f),t&&H(f)},[g,t,H,a,c]),E=_react.useCallback.call(void 0, ()=>{h(!0),w(!1),m&&H(l,!0)},[l,m,H]),C=_react.useCallback.call(void 0, ()=>{u(!0),w(!0)},[]),J=_react.useCallback.call(void 0, ()=>P(null,null,function*(){let i=yield B(l);return A(i),h(!0),d&&d(i===null,i),i===null}),[l,B,d]),z=_react.useCallback.call(void 0, ()=>{p(D.current),h(!1),u(!1),w(!1),A(null),k(!1),V.current&&clearTimeout(V.current)},[]),G=_react.useCallback.call(void 0, i=>{D.current=i,p(i),h(!1),A(null)},[]),Q=_react.useCallback.call(void 0, i=>{let f=c?c(i):i;p(f),a&&a(f)},[a,c]),X=_react.useCallback.call(void 0, ()=>({value:l,onChange:y,onBlur:E,onFocus:C,disabled:g}),[l,y,E,C,g]),Y=_react.useCallback.call(void 0, ()=>({value:l,onChange:i=>y(i.target.value),onBlur:E,onFocus:C,disabled:g}),[l,y,E,C,g]),Z=_react.useCallback.call(void 0, ()=>({value:l,onChange:i=>y(i.target.value),onBlur:E,onFocus:C,status:v&&x?"error":void 0,disabled:g}),[l,y,E,C,v,x,g]),_=_react.useCallback.call(void 0, (i="form-field-error")=>!v||!x||!M||F?null:_react2.default.createElement("div",{className:i},M),[v,x,M,F]);return _react.useEffect.call(void 0, ()=>()=>{V.current&&clearTimeout(V.current)},[]),{value:l,touched:v,dirty:U,pristine:q,valid:W,invalid:x,error:M,validating:$,visited:o,focused:F,disabled:g,onChange:y,onBlur:E,onFocus:C,setValue:Q,reset:z,validate:J,setError:A,setTouched:h,setDisabled:K,setInitialValue:G,getInputProps:X,getHTMLInputProps:Y,getAntdInputProps:Z,renderError:_}}function ae(n){let e=Object.keys(n),r=e.map(o=>{let u=te(n[o]);return[o,u]}),t=Object.fromEntries(r),m=_react.useCallback.call(void 0, ()=>P(null,null,function*(){return(yield Promise.all(e.map(u=>t[u].validate()))).every(u=>u)}),[t,e]),b=_react.useCallback.call(void 0, ()=>{e.forEach(o=>t[o].reset())},[t,e]),c=_react.useCallback.call(void 0, ()=>Object.fromEntries(e.map(o=>[o,t[o].value])),[t,e]),T=_react.useCallback.call(void 0, o=>{Object.entries(o).forEach(([u,F])=>{u in t&&t[u].setValue(F)})},[t]),a=_react.useCallback.call(void 0, o=>{Object.entries(o).forEach(([u,F])=>{u in t&&t[u].setInitialValue(F)})},[t]),d=_react.useMemo.call(void 0, ()=>e.some(o=>t[o].dirty),[t,e]),L=_react.useMemo.call(void 0, ()=>e.every(o=>t[o].valid),[t,e]),l=_react.useCallback.call(void 0, ()=>Object.fromEntries(e.map(o=>[o,t[o].error])),[t,e]),p=_react.useCallback.call(void 0, o=>{e.forEach(u=>t[u].setDisabled(o))},[t,e]),v=_react.useMemo.call(void 0, ()=>e.every(o=>t[o].disabled),[t,e]),h=_react.useMemo.call(void 0, ()=>({validateAll:m,resetAll:b,getValues:c,setValues:T,setInitialValues:a,isDirty:d,isValid:L,getErrors:l,setDisabled:p,isDisabled:v}),[m,b,c,T,a,d,L,l,p,v]);return{fields:t,form:h}}exports.useFormField = te; exports.useFormFields = ae; exports.validators = se;
