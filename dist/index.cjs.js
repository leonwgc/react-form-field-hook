"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }var P=(n,e,r)=>new Promise((t,m)=>{var b=a=>{try{f(r.next(a))}catch(d){m(d)}},T=a=>{try{f(r.throw(a))}catch(d){m(d)}},f=a=>a.done?t(a.value):Promise.resolve(a.value).then(b,T);f((r=r.apply(n,e)).next())});var _react = require('react'); var _react2 = _interopRequireDefault(_react);var ae={required:(n="This field is required")=>e=>!e||!e.trim()?n:null,email:(n="Invalid email format")=>e=>e&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?n:null,minLength:(n,e)=>r=>r&&r.length<n?e||`Minimum ${n} characters`:null,maxLength:(n,e)=>r=>r&&r.length>n?e||`Maximum ${n} characters`:null,pattern:(n,e)=>r=>r&&!n.test(r)?e:null,min:(n,e)=>r=>{let t=typeof r=="string"?parseFloat(r):r;return!isNaN(t)&&t<n?e||`Minimum value is ${n}`:null},max:(n,e)=>r=>{let t=typeof r=="string"?parseFloat(r):r;return!isNaN(t)&&t>n?e||`Maximum value is ${n}`:null},url:(n="Invalid URL format")=>e=>{try{return e&&new URL(e),null}catch(r){return n}},number:(n="Must be a number")=>e=>e&&isNaN(Number(e))?n:null,integer:(n="Must be an integer")=>e=>e&&!Number.isInteger(Number(e))?n:null,matches:(n,e="Values do not match")=>r=>r!==n()?e:null,oneOf:(n,e)=>r=>n.includes(r)?null:e||`Must be one of: ${n.join(", ")}`,validate:(n,e)=>r=>P(null,null,function*(){return(yield Promise.resolve(n(r)))?null:e}),phone:(n="Invalid phone number")=>e=>e&&!/^[\d\s\-+()]{7,}$/.test(e)?n:null};function re(n={}){let{initialValue:e="",rules:r=[],validateOnChange:t=!0,validateOnBlur:m=!0,validateDebounce:b=0,transform:T,compareWith:f,onValueChange:a,onValidationChange:d,disabled:B=!1}=n,[u,p]=_react.useState.call(void 0, e),[v,h]=_react.useState.call(void 0, !1),[o,l]=_react.useState.call(void 0, !1),[F,$]=_react.useState.call(void 0, !1),[I,A]=_react.useState.call(void 0, null),[S,k]=_react.useState.call(void 0, !1),[g,q]=_react.useState.call(void 0, B),N=_react.useRef.call(void 0, e),y=_react.useRef.call(void 0, ),U=_react.useRef.call(void 0, 0),O=_react.useRef.call(void 0, e),K=_react.useMemo.call(void 0, ()=>f?!f(u,N.current):u!==N.current,[u,f]),W=!K,x=I!==null,J=!x&&!S,H=_react.useCallback.call(void 0, i=>P(null,null,function*(){if(r.length===0)return null;let c=++U.current;k(!0);try{for(let L of r){let M=yield Promise.resolve(L(i));if(c!==U.current)return null;if(M)return k(!1),M}return k(!1),null}catch(L){return k(!1),"Validation error occurred"}}),[r]),j=_react.useCallback.call(void 0, (i,c=!1)=>P(null,null,function*(){y.current&&clearTimeout(y.current);let L=()=>P(null,null,function*(){let M=yield H(i);A(M),d&&d(M===null,M)});c||b===0?yield L():y.current=setTimeout(L,b)}),[H,b,d]),V=_react.useCallback.call(void 0, i=>{if(g)return;let c=T?T(i):i;p(c),O.current=c,a&&a(c),t&&j(c)},[g,t,j,a,T]),E=_react.useCallback.call(void 0, ()=>{h(!0),$(!1),m&&j(O.current,!0)},[m,j]),C=_react.useCallback.call(void 0, ()=>{l(!0),$(!0)},[]),z=_react.useCallback.call(void 0, ()=>P(null,null,function*(){let i=yield H(u);return A(i),h(!0),d&&d(i===null,i),i===null}),[u,H,d]),G=_react.useCallback.call(void 0, ()=>{p(N.current),O.current=N.current,h(!1),l(!1),$(!1),A(null),k(!1),y.current&&clearTimeout(y.current)},[]),Q=_react.useCallback.call(void 0, i=>{N.current=i,p(i),O.current=i,h(!1),A(null)},[]),X=_react.useCallback.call(void 0, i=>{let c=T?T(i):i;p(c),O.current=c,a&&a(c)},[a,T]),Y=_react.useCallback.call(void 0, ()=>({value:u,onChange:V,onBlur:E,onFocus:C,disabled:g}),[u,V,E,C,g]),Z=_react.useCallback.call(void 0, ()=>({value:u,onChange:i=>V(i.target.value),onBlur:E,onFocus:C,disabled:g}),[u,V,E,C,g]),_=_react.useCallback.call(void 0, ()=>({value:u,onChange:i=>V(i.target.value),onBlur:E,onFocus:C,status:v&&x?"error":void 0,disabled:g}),[u,V,E,C,v,x,g]),ee=_react.useCallback.call(void 0, (i="form-field-error")=>!v||!x||!I||F?null:_react2.default.createElement("div",{className:i},I),[v,x,I,F]);return _react.useEffect.call(void 0, ()=>()=>{y.current&&clearTimeout(y.current)},[]),{value:u,touched:v,dirty:K,pristine:W,valid:J,invalid:x,error:I,validating:S,visited:o,focused:F,disabled:g,onChange:V,onBlur:E,onFocus:C,setValue:X,reset:G,validate:z,setError:A,setTouched:h,setDisabled:q,setInitialValue:Q,getInputProps:Y,getHTMLInputProps:Z,getAntdInputProps:_,renderError:ee}}function le(n){let e=Object.keys(n),r=e.map(o=>{let l=re(n[o]);return[o,l]}),t=Object.fromEntries(r),m=_react.useCallback.call(void 0, ()=>P(null,null,function*(){return(yield Promise.all(e.map(l=>t[l].validate()))).every(l=>l)}),[t,e]),b=_react.useCallback.call(void 0, ()=>{e.forEach(o=>t[o].reset())},[t,e]),T=_react.useCallback.call(void 0, ()=>Object.fromEntries(e.map(o=>[o,t[o].value])),[t,e]),f=_react.useCallback.call(void 0, o=>{Object.entries(o).forEach(([l,F])=>{l in t&&t[l].setValue(F)})},[t]),a=_react.useCallback.call(void 0, o=>{Object.entries(o).forEach(([l,F])=>{l in t&&t[l].setInitialValue(F)})},[t]),d=_react.useMemo.call(void 0, ()=>e.some(o=>t[o].dirty),[t,e]),B=_react.useMemo.call(void 0, ()=>e.every(o=>t[o].valid),[t,e]),u=_react.useCallback.call(void 0, ()=>Object.fromEntries(e.map(o=>[o,t[o].error])),[t,e]),p=_react.useCallback.call(void 0, o=>{e.forEach(l=>t[l].setDisabled(o))},[t,e]),v=_react.useMemo.call(void 0, ()=>e.every(o=>t[o].disabled),[t,e]),h=_react.useMemo.call(void 0, ()=>({validateAll:m,resetAll:b,getValues:T,setValues:f,setInitialValues:a,isDirty:d,isValid:B,getErrors:u,setDisabled:p,isDisabled:v}),[m,b,T,f,a,d,B,u,p,v]);return{fields:t,form:h}}exports.useFormField = re; exports.useFormFields = le; exports.validators = ae;
